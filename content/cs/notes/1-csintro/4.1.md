---
title: 4.1 Python程序设计基础
---

本节主要针对已熟悉 Python 语法的读者，总结考试中容易混淆或需要记忆的细节，如运算符优先级、切片边界、格式化符号等。

## 1. 运算符优先级 (Operator Precedence)

从高到低排列（同一行优先级相同，从左到右结合，除了幂运算 `**` 是从右到左）：

| 运算符                                                           | 描述                       | 示例/备注                                     |
| :--------------------------------------------------------------- | :------------------------- | :-------------------------------------------- |
| `(...)`, `[...]`, `{...}`                                        | 括号、列表、字典/集合显示  | 最优先                                        |
| `x[i]`, `x[i:j]`, `x.attr`, `f(...)`                             | 下标、切片、属性、函数调用 |                                               |
| `**`                                                             | **幂运算**                 | `2**3**2` 等于 `2**(3**2) = 512` (**右结合**) |
| `~`, `+x`, `-x`                                                  | 按位取反、正负号           | 一元运算符                                    |
| `*`, `/`, `//`, `%`                                              | 乘、除、整除、取模         | `//` 向下取整 (floor)                         |
| `+`, `-`                                                         | 加、减                     |                                               |
| `<<`, `>>`                                                       | 移位                       |                                               |
| `&`                                                              | 按位与                     |                                               |
| `^`                                                              | 按位异或                   |                                               |
| `\|`                                                             | 按位或                     |                                               |
| `in`, `not in`, `is`, `is not`, `<`, `<=`, `>`, `>=`, `!=`, `==` | 比较运算符                 | 优先级相同，支持链式比较 `a < b < c`          |
| `not`                                                            | 逻辑非                     |                                               |
| `and`                                                            | 逻辑与                     | 短路特性：`False and x` 返回 `False`          |
| `or`                                                             | 逻辑或                     | 短路特性：`True or x` 返回 `True`             |
| `if` - `else`                                                    | 条件表达式                 | `x if c else y`                               |
| `lambda`                                                         | Lambda 表达式              |                                               |
| `:=`                                                             | 海象运算符 (Python 3.8+)   | 最低优先级                                    |

{{< callout >}}

**易错点**：

- `not a == b` 等价于 `not (a == b)`，因为 `==` 优先级高于 `not`。
- `a and b or c`：先算 `and`，再算 `or`。
- `-3**2` 结果是 `-9`，因为 `**` 优先级高于一元负号 `-`。

{{</ callout >}}

## 2. 切片语法 (Slicing)

语法：`sequence[start:stop:step]`

- **区间**：左闭右开 `[start, stop)`。
- **索引**：
  - 正索引：`0` 到 `len-1`。
  - 负索引：`-1` (最后一个) 到 `-len`。
- **缺省值**：
  - `start` 默认为 `0` (若 step > 0) 或 `len-1` (若 step < 0)。
  - `stop` 默认为 `len` (若 step > 0) 或 `-len-1` (若 step < 0)。
  - `step` 默认为 `1`。

**常见操作与边界**：

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

a[2:5]    # [2, 3, 4]
a[:3]     # [0, 1, 2] (前3个)
a[-3:]    # [7, 8, 9] (后3个)
a[::2]    # [0, 2, 4, 6, 8] (偶数位置)
a[::-1]   # [9, 8, ..., 0] (逆序)
a[5:2:-1] # [5, 4, 3] (逆序切片，注意 stop 是 2，不包含 a[2])
```

{{< callout >}}

**注意** 切片操作不会因为索引越界而报错（会返回空列表或尽可能多的元素），但直接访问索引 `a[100]` 会报 `IndexError`。

{{</ callout >}}

## 3. 数据类型与可变性 (Mutability)

| 类型                              | 可变性 (Mutable) | 备注                                              |
| :-------------------------------- | :--------------- | :------------------------------------------------ |
| `int`, `float`, `bool`, `complex` | **不可变**       | 数值类型                                          |
| `str`                             | **不可变**       | 字符串修改会产生新对象                            |
| `tuple`                           | **不可变**       | 元组，但元组内的元素若是可变对象(如 list)则可修改 |
| `list`                            | **可变**         | 列表                                              |
| `dict`                            | **可变**         | 字典，键必须是**不可变**类型 (hashable)           |
| `set`                             | **可变**         | 集合，元素必须是**不可变**类型                    |
| `frozenset`                       | **不可变**       | 不可变集合，可作为字典的键                        |

**真值判断 (Truthy/Falsy)**：
以下值在布尔上下文中被视为 `False`：

- `None`
- `False`
- 数值零：`0`, `0.0`, `0j`
- 空序列/集合：`''`, `[]`, `()`, `{}`, `set()`

## 4. 字符串格式化 (String Formatting)

### f-string (推荐, Python 3.6+)

语法：`f"{value:format_spec}"`

- **对齐**：`<` (左), `>` (右), `^` (居中)。
- **填充**：`{x:*^10}` (用 `*` 填充，居中，总宽 10)。
- **精度**：`.nf` (保留 n 位小数)。
- **类型**：`d` (整数), `f` (浮点), `e` (科学计数), `b` (二进制), `x` (十六进制), `%` (百分比)。

```python
pi = 3.1415926
val = 42

f"{pi:.2f}"      # '3.14'
f"{pi:+.2f}"     # '+3.14' (显示符号)
f"{val:05d}"     # '00042' (补零)
f"{val:<5d}"     # '42   ' (左对齐)
f"{val:#x}"      # '0x2a'  (十六进制带前缀)
f"{0.25:.1%}"    # '25.0%' (百分比)
```

### `%` 占位符 (旧式)

| 占位符      | 描述                   | 示例                          |
| :---------- | :--------------------- | :---------------------------- |
| `%s`        | 字符串 (调用 str())    | `"%s" % [1,2]` -> `'[1, 2]'`  |
| `%d`        | 有符号十进制整数       | `"%d" % 3.9` -> `'3'` (截断)  |
| `%f`        | 浮点数 (默认 6 位小数) | `"%.2f" % 3.1415` -> `'3.14'` |
| `%x` / `%X` | 十六进制整数           | `"%x" % 15` -> `'f'`          |
| `%e` / `%E` | 科学计数法             |                               |
| `%%`        | 输出字面量 `%`         | `"%d%%" % 50` -> `'50%'`      |

## 5. 常用内置函数细节

- **`sort()` vs `sorted()`**:
  - `list.sort()`: **原地**排序，返回 `None`。
  - `sorted(iterable)`: 返回**新列表**，原数据不变。
- **`append()` vs `extend()`**:
  - `a.append(b)`: 将 `b` 作为一个元素加到 `a` 末尾。
  - `a.extend(b)`: 将 `b` (必须是可迭代对象) 中的元素逐个加到 `a` 末尾。
- **`range(start, stop, step)`**:
  - 惰性序列 (Python 3)。
  - `list(range(3))` -> `[0, 1, 2]`。
- **`zip(iter1, iter2)`**:
  - 打包成元组的迭代器。
  - 长度以**最短**的序列为准。
