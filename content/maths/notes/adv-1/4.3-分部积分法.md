---
title: 4.3 分部积分法
---

分部积分法是利用两个函数乘积的求导法则推导出来的积分方法，主要用于处理被积函数是**两类不同类型函数乘积**的情况。

## 一、分部积分法的原理和公式

### 1. 原理

分部积分法的公式来源于乘积函数的求导法则：

$$[u(x) v(x)]' = u'(x) v(x) + u(x) v'(x)$$

将上式两边同时对 $x$ 求不定积分：

$$\int [u(x) v(x)]' \, \mathrm{d} x = \int u'(x) v(x) \, \mathrm{d} x + \int u(x) v'(x) \, \mathrm{d} x$$

$$u(x) v(x) = \int v(x) \, \mathrm{d} u(x) + \int u(x) \, \mathrm{d} v(x)$$

### 2. 分部积分公式

移项得到分部积分公式：

$$\int u(x) \, \mathrm{d} v(x) = u(x) v(x) - \int v(x) \, \mathrm{d} u(x)$$

> **核心思想：** 将难以直接求解的 $\int u \, \mathrm{d} v$ 转化为可能更易求解的 $\int v \, \mathrm{d} u$。

## 二、使用分部积分法的关键：选择 $u$ 和 $\mathrm{d} v$

分部积分法的成功与否，完全取决于对被积函数 $f(x) \, \mathrm{d} x$ 进行**恰当的分组**，即合理选择 $u$ 和 $\mathrm{d} v$。

### 1. 选择原则

理想的选择应该满足两个条件：

1. **$u$ 容易求导：** $u$ 必须求导后形式更简单，或能够消掉。

2. **$\mathrm{d} v$ 容易求积分：** $\int \mathrm{d} v = v$ 必须能够容易地求出。

### 2. 选取 $u$ 的口诀（优先级从高到低）

**“反对幂三指”** 是选取 $u$ 的常用经验法则：

| **字母** | **代表函数类型 (u)**                    | **积分处理方式 (dv)**          |
| -------- | --------------------------------------- | ------------------------------ |
| **反**   | 反三角函数（如 $\arctan x, \arcsin x$） | 令 $\mathrm{d} v$ 为剩余所有项 |
| **对**   | 对数函数（如 $\ln x$）                  | 令 $\mathrm{d} v$ 为剩余所有项 |
| **幂**   | 幂函数（如 $x^n, \frac{1}{x^n}$）       | 令 $\mathrm{d} v$ 为剩余所有项 |
| **三**   | 三角函数（如 $\sin x, \cos x$）         | 令 $\mathrm{d} v$ 为剩余所有项 |
| **指**   | 指数函数（如 $e^{ax}, a^x$）            | 令 $\mathrm{d} v$ 为剩余所有项 |

> **口诀解读：** 在一个乘积函数中，谁在口诀中排名靠前，谁就应该选为 $u$（要求导），剩下的部分全部设为 $\mathrm{d} v$ （要求积分）。

## 三、分部积分的常见类型与应用

### 1. 反对函数与幂函数的乘积（“反”、“对”型）

这类积分的特点是 $u$ 求导后变为有理函数，而 $\mathrm{d} v$ 容易积分。

- **例子 1：** $\int x \ln x \, \mathrm{d} x$

  - 根据口诀，“对” ($\ln x$) 优先于 “幂” ($x$)。

  - 设 $u = \ln x$, $\mathrm{d} v = x \, \mathrm{d} x$。

  - 则 $\mathrm{d} u = \frac{1}{x} \, \mathrm{d} x$, $v = \frac{1}{2} x^2$。

  - $\int x \ln x \, \mathrm{d} x = \frac{1}{2} x^2 \ln x - \int \frac{1}{2} x^2 \cdot \frac{1}{x} \, \mathrm{d} x = \frac{1}{2} x^2 \ln x - \frac{1}{4} x^2 + C$。

- **例子 2：** $\int \arctan x \, \mathrm{d} x$

  - 由于 $\arctan x$ 是单独出现的，我们仍然把它看作 $\arctan x \cdot 1$。

  - 设 $u = \arctan x$, $\mathrm{d} v = 1 \, \mathrm{d} x$。

  - 则 $\mathrm{d} u = \frac{1}{1+x^2} \, \mathrm{d} x$, $v = x$。

  - $\int \arctan x \, \mathrm{d} x = x \arctan x - \int \frac{x}{1+x^2} \, \mathrm{d} x$ (后续使用凑微分法)。

### 2. 幂函数与三角/指数函数的乘积（“幂三”、“幂指”型）

这类积分通常需要**多次**使用分部积分法，直到幂函数 $x^n$ 的指数降为 0 或 1。

- **例子：** $\int x^2 e^x \, \mathrm{d} x$

  - 根据口诀，“幂” ($x^2$) 优先于 “指” ($e^x$)。

  - 设 $u = x^2$, $\mathrm{d} v = e^x \, \mathrm{d} x$。

  - 一次分部积分后，积分项变为 $\int 2x e^x \, \mathrm{d} x$，仍需要再进行一次分部积分。

### 3. 三角函数与指数函数的乘积（“三指”型）

这类积分无法通过降幂完成，但通常会得到一个**原积分的代数方程**。

- **例子：** $I = \int e^x \sin x \, \mathrm{d} x$

  - 第一次分部积分： (任意选择 $u$ 和 $\mathrm{d} v$，保持一致即可)

    设 $u_1 = \sin x$, $\mathrm{d} v_1 = e^x \, \mathrm{d} x$。

    $I = e^x \sin x - \int e^x \cos x \, \mathrm{d} x$

  - 第二次分部积分： (保持 $u$ 仍然是三角函数)

    对 $\int e^x \cos x \, \mathrm{d} x$，设 $u_2 = \cos x$, $\mathrm{d} v_2 = e^x \, \mathrm{d} x$。

    $\int e^x \cos x \, \mathrm{d} x = e^x \cos x - \int e^x (-\sin x) \, \mathrm{d} x = e^x \cos x + \int e^x \sin x \, \mathrm{d} x$

  - 代入原式并求解方程：

    $I = e^x \sin x - [e^x \cos x + I]$

    $2I = e^x (\sin x - \cos x)$

    $I = \frac{1}{2} e^x (\sin x - \cos x) + C$
