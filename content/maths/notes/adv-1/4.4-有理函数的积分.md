---
title: 4.4 有理函数的积分
---

## 一、有理函数的定义与基本策略

### 1. 有理函数的定义

有理函数是指可以表示为两个多项式之比的函数 $R(x)$：

$$R(x) = \frac{P(x)}{Q(x)}$$

其中 $P(x)$ 为分子多项式， $Q(x)$ 为分母多项式。

### 2. 基本分类

- **真分式：** $\text{deg}(P(x)) < \text{deg}(Q(x))$ （分子次数严格小于分母次数）。
- **假分式：** $\text{deg}(P(x)) \ge \text{deg}(Q(x))$ （分子次数大于或等于分母次数）。

### 3. 积分基本策略（三步法）

求解有理函数积分的通用方法是将其分解为容易积分的最简部分分式。

1. 降次处理（针对假分式）： 使用多项式长除法，将假分式拆分为一个多项式和一个真分式的和。

   $$\int \frac{P(x)}{Q(x)} \, \mathrm{d} x = \int \left[ S(x) + \frac{R(x)}{Q(x)} \right] \, \mathrm{d} x$$

   其中 $S(x)$ 是商式，$\text{deg}(R(x)) < \text{deg}(Q(x))$。

2. **分母因式分解：** 将真分式的分母 $Q(x)$ 在实数范围内彻底分解为**一次因式**和**不可再分解的二次因式**的乘积。
3. **部分分式拆分：** 使用待定系数法将真分式拆分成若干个**最简部分分式**的和。

## 二、部分分式拆分的规则（待定系数法）

根据分母 $Q(x)$ 的因式分解形式，确定拆分后部分分式的形式。

### 1. 对应一次因式 $(x-a)^k$

对于分母 $Q(x)$ 中含有的因式 $(x-a)^k$，对应的部分分式应拆分为 $k$ 项：

$$\frac{A_1}{x-a} + \frac{A_2}{(x-a)^2} + \cdots + \frac{A_k}{(x-a)^k}$$

### 2. 对应二次因式 $(x^2+px+q)^m$

对于分母 $Q(x)$ 中含有的不可再分解的二次因式 $(x^2+px+q)^m$，对应的部分分式应拆分为 $m$ 项：

$$\frac{B_1 x + C_1}{x^2+px+q} + \frac{B_2 x + C_2}{(x^2+px+q)^2} + \cdots + \frac{B_m x + C_m}{(x^2+px+q)^m}$$

### 3. 综合示例

例如，对于有理函数 $\frac{x + 2}{(2x+1)(x^{2}+x + 1)}$，分母包含一个一次因式 $(2x+1)$ 和一个不可再分解的二次因式 $(x^2+x+1)$。

其拆分形式为：

$$ \frac{x + 2}{(2x+1)(x^{2}+x + 1)} = \frac{A}{2x+1} + \frac{Bx+C}{x^2+x+1} $$

**求解过程：**

通分去掉分母：
$$ x + 2 = A(x^2+x+1) + (Bx+C)(2x+1) $$

1. **求 $A$（取值法）：**
   令 $2x+1=0$，即 $x = -\frac{1}{2}$，代入上式：
   $$ -\frac{1}{2} + 2 = A\left((-\frac{1}{2})^2 + (-\frac{1}{2}) + 1\right) $$
   $$ \frac{3}{2} = A \cdot \frac{3}{4} \implies A = 2 $$

2. **求 $B, C$（比较系数法）：**
   整理右边各项系数：
   $$ x + 2 = (A + 2B)x^2 + (A + B + 2C)x + (A + C) $$
   比较 $x^2$ 项系数：$A + 2B = 0 \implies 2 + 2B = 0 \implies B = -1$。
   比较常数项：$A + C = 2 \implies 2 + C = 2 \implies C = 0$。

最终结果：
$$ \frac{x + 2}{(2x+1)(x^{2}+x + 1)} = \frac{2}{2x+1} - \frac{x}{x^2+x+1} $$

## 三、最简部分分式的积分求解

任何有理函数的积分最终都会转化为以下四种基本类型（或通过配方转化为后三者）的积分：

### 1. 多项式的积分

$$\int S(x) \, \mathrm{d} x$$

直接使用幂函数积分公式。

### 2. 第一类型最简分式积分

#### A. 简单一次因式（$k=1$）

$$\int \frac{A}{x-a} \, \mathrm{d} x = A \ln |x-a| + C$$

#### B. 高次一次因式（$k>1$）

$$\int \frac{A}{(x-a)^k} \, \mathrm{d} x = A \int (x-a)^{-k} \, \mathrm{d} (x-a) = \frac{A}{(1-k)(x-a)^{k-1}} + C$$

### 3. 第二类型最简分式积分（二次不可分解）

这类积分的关键是**分母配方**，然后将分子拆分成**微分形式**和**常数形式**。

设 $x^2+px+q$ 配方后为 $(x+b)^2 + c^2$，且令 $u = x+b$。

$$\int \frac{A x + B}{x^2 + p x + q} \, \mathrm{d} x$$

- 步骤 1：凑微分（产生对数项）

  将分子 $Ax+B$ 凑成 $A(x+b)$ 的导数形式 $2(x+b)$。

  $$\frac{A x + B}{x^2 + p x + q} = \frac{A}{2} \cdot \frac{2(x+b)}{x^2+px+q} + \frac{B'}{x^2+px+q}$$

  $$\int \frac{A}{2} \cdot \frac{2u \, \mathrm{d} u}{u^2+c^2} = \frac{A}{2} \ln (u^2+c^2)$$

- 步骤 2：凑反正切（产生反正切项）

  对剩余的常数项进行积分。

  $$\int \frac{B'}{u^2+c^2} \, \mathrm{d} u = \frac{B'}{c} \arctan \left(\frac{u}{c}\right)$$

### 4. 第二类型高次幂分式积分（$m \ge 2$）

$$\int \frac{A x + B}{(x^2 + p x + q)^m} \, \mathrm{d} x \quad (m \ge 2)$$

- **处理方法：** 同样通过**凑微分**将 $Ax+B$ 拆分成 $A_1 \cdot 2(x+\frac{p}{2})$ 和 $B_1$。

  - **微分项：** 转化为 $\int \frac{\mathrm{d} u}{(u^2+c^2)^m}$ 形式，使用换元法和幂函数公式求解。
  - **常数项：** 转化为 $\int \frac{\mathrm{d} u}{(u^2+c^2)^m}$ 形式，通常需要使用**三角代换**或**递推公式**求解。

## 四、待定系数法的具体操作技巧

在 $\frac{R(x)}{Q(x)} = \text{部分分式}$ 的恒等式中，确定待定系数 $A, B, \dots$ 的常用技巧：

1. **比较系数法：** 将等式两边通分后，按 $x$ 的同次幂项的系数相等列方程组求解。
2. **取值法（代入法）：** 在通分后的恒等式中，代入 $Q(x)$ 的实数根（如 $x=a$），可以直接求出部分系数。
3. **混合法：** 先使用取值法求出容易确定的系数，再使用比较系数法求解剩余的系数。
